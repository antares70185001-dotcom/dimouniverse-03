<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë””ëª¨ ë°œëª… ì¹´ë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700;800&display=swap" rel="stylesheet">
  <style>
    :root { 
      --main:#5cab6d;
      --accent:#a5e6b8;
      --bg:#f8fff9;
    }
    *{box-sizing:border-box}
    body { font-family:"Arial",sans-serif; background:var(--bg); text-align:center; margin:0; padding:20px; }
    .screen { display:none; } 
    .active { display:block; }
    video { width:780px; max-width:100%; border-radius:20px; margin:20px auto; display:block; box-shadow:0 12px 40px rgba(0,0,0,0.3); }
    
    .title { 
      font-family:'Jua', sans-serif; 
      font-size:58px; 
      font-weight:bold; 
      margin:15px 0; 
      color:var(--main); 
      text-shadow:2px 2px 6px rgba(0,0,0,0.2);
    }

    /* ì„¤ë¬¸ ìƒë‹¨ ì œëª© */
    .section-title{
      font-family:'Jua', sans-serif;
      font-size:28px;
      font-weight:700;
      color:#2d4d38;
      margin:10px auto 6px;
      width:100%;
      max-width:680px;
      text-align:left;
    }
    
    .start-btn{ margin:20px auto; background:var(--accent); border:none; padding:14px 32px; border-radius:30px; cursor:pointer; font-size:20px; font-weight:bold; color:#2d4d38; transition:all .3s ease; display:inline-block; box-shadow:0 6px 14px rgba(0,0,0,0.15);}
    .start-btn:hover{ background:#8ed8a3; transform:scale(1.05); }
    form{ background:#fff; border-radius:20px; padding:30px; display:flex; flex-direction:column; text-align:left; max-width:680px; width:100%; margin:20px auto; box-shadow:0 6px 20px rgba(0,0,0,0.1); border:3px solid var(--accent);}
    .form-group{ margin-bottom:20px; }
    label{ font-weight:bold; font-size:17px; color:#000000; display:block; margin-bottom:8px; }
    input,textarea,select{ width:100%; padding:12px; border-radius:10px; border:2px solid #d3f2db; font-size:15px; background:#fafffa; transition:border 0.3s, box-shadow 0.3s; }
    input:focus,textarea:focus,select:focus{ outline:none; border:2px solid var(--main); box-shadow:0 0 8px rgba(92,171,109,0.3); }
    #ideaForm button[type="submit"] { display:block; margin:20px auto 0 auto; }
    .privacy-check{ display:flex; align-items:center; gap:8px; margin-top:10px; }
    .privacy-check input{ width:20px; height:20px; accent-color: var(--main); }
    .privacy-note{ font-size:13px; color:#333; background:#f3fff6; padding:12px; border-radius:10px; border:1px dashed var(--main); }
    
    /* ğŸ‰ ì¹­ì°¬ ì¹´ë“œ */
    .celebration-card{
      background:#ffffff;
      border:3px solid var(--accent);
      border-radius:20px;
      padding:12px;
      max-width:520px;
      margin:0 auto 12px;
      box-shadow:0 8px 24px rgba(0,0,0,0.12);
      position:relative;
      width:100%;
      text-align:left;
    }
    .banner{ 
      font-family:'Jua', sans-serif; 
      font-size:32px; 
      font-weight:bold; 
      color:var(--main); 
      margin:0 0 8px 0;          
      text-align:center; 
      width:100%; 
      text-shadow:2px 2px 6px rgba(0,0,0,0.25);
    }
    .card-body{ display:flex; align-items:center; gap:20px; width:100%; }
    .dimo-left{ width:176px; height:auto; border-radius:16px; flex-shrink:0; align-self:center; }
    .ratings-wrap{ flex:1; text-align:left; }
    .rating{ display:flex; justify-content:space-between; align-items:center; background:#f9fffb; border:2px solid #d3f2db; border-radius:10px; padding:8px 12px; margin:6px 0; white-space:nowrap; }
    .rating h3{ margin:0; font-size:16px; font-weight:bold; color:#2d4d38; }
    .stars { display:flex; gap:4px; }
    .star { position:relative; font-size:28px; color:#d8d8d8; }
    .star.full { color:#ffcc00; text-shadow:1px 1px 6px rgba(255,204,0,0.7);}
    .star.half::before {
      content:"â˜…";
      position:absolute;
      left:0; top:0;
      width:50%; overflow:hidden;
      color:#ffcc00;
      text-shadow:1px 1px 6px rgba(255,204,0,0.7);
    }
    .idea-info { 
      margin-top:12px; 
      margin-bottom:36px;        
      font-size:20px; 
      font-weight:bold; 
      color:#333; 
      text-align:center; 
      background:#f9fffb; 
      padding:10px 14px;         
      border-radius:16px; 
      border:2px solid #d3f2db; 
      max-width:580px; 
      margin-left:auto; 
      margin-right:auto; 
      line-height:1.8;
    }
    .idea-info strong { color: var(--main);}
    
    /* ğŸ¯ ìŠ¤íƒ¬í”„ ì˜ì—­ */
    #stampArea {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
    }

    /* ë¡œê³ (ì˜ë¬¸) */
    .card-footer-logo{
      position:absolute;
      left:0; right:0; bottom:8px;
      text-align:center;
      font-size:22px;
      font-weight:700;
      letter-spacing:0.18em;
      text-transform:uppercase;
      color:#8aa0a6;
      opacity:.8;
      pointer-events:none;
      user-select:none;
    }

    /* ğŸ“± ëª¨ë°”ì¼ ìµœì í™” */
    @media (max-width: 480px){
      body { padding: 12px; }
      .title { font-size: 36px; margin: 12px 0; }
      .banner { font-size: 24px; }
      .card-body { gap: 12px; }
      .dimo-left { width: 132px; border-radius: 14px; }
      .rating { padding: 6px 10px; margin: 5px 0; }
      .rating h3 { font-size: 14px; }
      .star { font-size: 22px; }
      .idea-info { font-size: 16px; padding: 8px 12px; margin-bottom: 28px; }
      .start-btn { padding: 12px 20px; font-size: 18px; }
      .card-footer-logo { font-size:20px; bottom:6px; }
      .section-title{ font-size:22px; max-width:92%; }
    }

    /* ë¡œê³  ê·¸ë¼ë°ì´ì…˜ & ì¹´ë“œ ì—¬ë°± ìŠ¬ë¦¼ (ì›ë³¸ ìœ ì§€) */
    .card-footer-logo{
      font-family:'Baloo 2', cursive, sans-serif !important;
      font-size:31px !important;
      letter-spacing:0.12em !important;
      text-transform:uppercase !important;
      background:linear-gradient(90deg,#5cab6d,#3c9d9b,#6a5acd);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      color:transparent !important;
      text-align:center !important;
      bottom:10px !important;
      opacity:1 !important;
    }
    .celebration-card{ padding-bottom:56px !important; }
    .banner{ margin:0 0 4px 0 !important; }
    .card-body{ gap:16px !important; }
    .rating{ padding:6px 10px !important; margin:4px 0 !important; } 
    .idea-info{ margin-top:8px !important; margin-bottom:16px !important; padding:8px 12px !important; }
    @media (max-width:480px){
      .card-footer-logo{ font-size:28px !important; bottom:8px !important; }
      .celebration-card{ padding-bottom:52px !important; }
      .card-body{ gap:12px !important; }
      .rating{ padding:5px 9px !important; margin:4px 0 !important; }
      .idea-info{ margin-bottom:14px !important; }
    }

    /* ìŠ¤íƒ¬í”„ ì‹¤ê° ì• ë‹ˆë©”ì´ì…˜(ì›ë³¸ ìœ ì§€) */
    .stamp-enter{
      transform-origin:center;
      mix-blend-mode:multiply;
      filter: drop-shadow(0 6px 12px rgba(0,0,0,.10));
      animation:
        stamp-pop 520ms cubic-bezier(.18,1.4,.22,1) forwards,
        ink-fade 1200ms ease-out forwards;
    }
    @keyframes stamp-pop{
      0%   { opacity:0; transform: translateY(-16px) scale(1.35) rotate(var(--r,-4deg)); filter: blur(1px) drop-shadow(0 24px 36px rgba(0,0,0,.18)); }
      65%  { opacity:1; transform: translateY(0)     scale(0.97) rotate(var(--r,-4deg)); filter: drop-shadow(0 10px 18px rgba(0,0,0,.14)); }
      100% {             transform: scale(1)          rotate(var(--r,-4deg));            filter: drop-shadow(0 6px 12px rgba(0,0,0,.10)); }
    }
    @keyframes ink-fade{ from{filter:saturate(1.15) contrast(1.1);} to{filter:saturate(1) contrast(1);} }

    /* ì¸íŠ¸ë¡œ ì œëª© ì•ˆì „ ë¦¬ì…‹ + ì¡°ê±´ë¶€ ê·¸ë¼ë°ì´ì…˜(ì›ë³¸ ìœ ì§€) */
    #introScreen .title{
      font-family:'Baloo 2','Jua','Apple SD Gothic Neo','Noto Sans KR','Malgun Gothic',sans-serif !important;
      font-weight:800 !important;
      letter-spacing:.02em;
      color:#5cab6d !important;
      -webkit-text-fill-color:initial !important;
      background:none !important;
      text-shadow:none !important;
      display:block !important;
      margin-bottom:10px !important;
    }
    #introScreen .start-btn{
      display:block !important;
      margin:10px auto 0 !important;
    }
    .text-gradient-ok #introScreen .title{
      background:linear-gradient(90deg,#5cab6d,#3c9d9b,#6a5acd) !important;
      -webkit-background-clip:text !important; background-clip:text !important;
      -webkit-text-fill-color:transparent !important;
      color:transparent !important;
    }

    /* ì¹´ë“œ ë¯¸ì„¸ í”ë“¤ë¦¼ë§Œ ì‚¬ìš© */
    .celebration-card.paper-jolt{ animation: paper-jolt 220ms cubic-bezier(.3,.7,.4,1) 1; }
    @keyframes paper-jolt{
      0%{ transform: translateY(0) rotate(0); }
      30%{ transform: translateY(1px) rotate(-0.25deg); }
      60%{ transform: translateY(0) rotate(0.15deg); }
      100%{ transform: translateY(0) rotate(0); }
    }
  </style>

  <script>
    /* ê·¸ë¼ë°ì´ì…˜ ì§€ì› í™•ì¸ (ì›ë¬¸ ìœ ì§€) */
    (function(){
      try{
        var ok = (window.CSS && CSS.supports) && (CSS.supports('-webkit-background-clip','text') || CSS.supports('background-clip','text'));
        if(ok){
          var test=document.createElement('div');
          test.style.cssText='position:absolute;left:-9999px;top:-9999px;background:linear-gradient(#000,#fff);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;';
          test.textContent='T';
          document.documentElement.appendChild(test);
          var cs=getComputedStyle(test);
          var fill=cs.webkitTextFillColor || cs.color;
          test.remove();
          if(fill==='rgba(0, 0, 0, 0)' || fill==='transparent'){
            document.documentElement.classList.add('text-gradient-ok');
          }
        }
      }catch(e){}
    })();
  </script>
</head>
<body>
  <!-- 1) ì¸íŠ¸ë¡œ -->
  <div id="introScreen" class="screen active">
    <h1 class="title">ë””ëª¨ë‘ í•¨ê»˜í•˜ëŠ” ë°œëª… ë†€ì´í„° âœ¨</h1>
    <button id="introBtn" class="start-btn">â–¶ ë””ëª¨ ë§Œë‚˜ëŸ¬ ê°€ê¸°</button>
    <video autoplay muted loop playsinline webkit-playsinline>
      <source src="dimo.mp4" type="video/mp4">
    </video>
    <audio id="introAudio1" src="ë””ëª¨ ì¸íŠ¸ë¡œ ì¸ì‚¬.mp3" preload="auto"></audio>
    <audio id="introAudio2" src="ë””ëª¨ì¸ì‚¬01.mp3" preload="auto"></audio>
    <audio id="introAudio3" src="ë””ëª¨ì¸ì‚¬02.mp3" preload="auto"></audio>
    <audio id="introAudio4" src="ë””ëª¨ì¸ì‚¬03.mp3" preload="auto"></audio>
    <p style="font-size:12px;color:#555;margin:4px 0 0">â€» ì†Œë¦¬ê°€ ì•ˆ ë“¤ë¦¬ë©´ ê¸°ê¸° ë¬´ìŒ í•´ì œ ë° ë³¼ë¥¨ì„ ì˜¬ë ¤ì£¼ì„¸ìš”.</p>
  </div>

  <!-- 2) ì„¤ë¬¸ -->
  <div id="formScreen" class="screen">
    <h2 class="section-title">ğŸ“£ ë””ëª¨ì—ê²Œ ì•Œë ¤ì¤˜</h2>
    <form id="ideaForm">
      <div class="form-group">
        <label>1. ë””ëª¨ëŠ” ì¹œêµ¬ ë‚˜ì´ê°€ ê¶ê¸ˆí•´! *</label>
        <select id="age" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="8">8ì„¸</option><option value="9">9ì„¸</option><option value="10">10ì„¸</option>
          <option value="11">11ì„¸</option><option value="12">12ì„¸</option><option value="13">13ì„¸</option>
          <option value="14">14ì„¸</option><option value="15">15ì„¸</option><option value="16">16ì„¸</option>
          <option value="17">17ì„¸</option><option value="18">18ì„¸</option><option value="19">19ì„¸</option>
        </select>
      </div>

      <div class="form-group">
        <label>2. ë””ëª¨ì—ê²Œ ë„ˆë§Œì˜ ë©‹ì§„ ë³„ëª…ì„ ì •í•´ì¤˜! (ì‹¤ëª…ë§ê³  ë³„ëª…ìœ¼ë¡œ) *</label>
        <input type="text" id="nickname" placeholder="ì˜ˆ: ë°œëª…ì™• ë””ëª¨!" required>
      </div>

      <div class="form-group">
        <label>3. í‰ì†Œì— "ì•„~ ì´ê±° ë¶ˆí¸í•˜ë‹¤!" ì‹¶ì—ˆë˜ ìˆœê°„ì´ ìˆì—ˆì–´? ë””ëª¨í•œí…Œ ë§í•´ì¤„ë˜? *</label>
        <textarea id="problem" placeholder="ì˜ˆ: ì—°í•„ì´ ìê¾¸ êµ´ëŸ¬ê°€ì„œ ìƒì–´ë²„ë ¤ìš”" required></textarea>
      </div>

      <div class="form-group">
        <label>4. ê·¸ ë¶ˆí¸ì„ í•´ê²°í•  ë©‹ì§„ ë°œëª…í’ˆ ì´ë¦„ì„ ë”±! ì§€ì–´ë³¼ê¹Œ? *</label>
        <input type="text" id="ideaName" placeholder="ì˜ˆ: ì•ˆ êµ´ëŸ¬ê°€ëŠ” ì—°í•„" required>
      </div>

      <div class="form-group">
        <label>5. ì´ ë°œëª…í’ˆì€ ì–´ë–»ê²Œ ì‘ë™í•˜ê³  ì–´ë–¤ì ì´ í¸ë¦¬í•´ ì§€ëŠ”ê±°ì•¼? *</label>
        <textarea id="ideaDetail" placeholder="ì˜ˆ: ì—°í•„ì— ì‘ì€ ìì„ì´ ë¶™ì–´ì„œ ì±…ìƒì— ë”± ë‹¬ë¼ ë¶™ì–´ìš”. ê·¸ë˜ì„œ ì§€ìš°ê°œë¥¼ ì˜ ìŠì–´ë²„ë¦¬ì§€ ì•Šê³  í•„ìš”í•  ë•Œë§ˆë‹¤ ì“¸ ìˆ˜ ìˆì–´ìš”. (30ì ì´ìƒ ì‘ì„±í•˜ë©´ ë””ëª¨ê°€ ìŠ¤íƒ¬í”„ë¥¼ ì°ì–´ì¤„ê±°ì•¼!)" required></textarea>
      </div>

      <div class="form-group">
        <label>6. ë””ëª¨ëŠ” ë¶€ëª¨ë‹˜ê»˜ë„ ì¸ì‚¬ë“œë¦¬ê³  ì‹¶ì€ë°? ë³´í˜¸ì ì„±í•¨ì„ ì•Œë ¤ì¤„ë˜? *</label>
        <input type="text" id="parentName" placeholder="ì˜ˆ: ê¹€ì² ìˆ˜" required>
      </div>

      <div class="form-group">
        <label>7. í˜¹ì‹œ ë””ëª¨ê°€ ì—°ë½ë“œë ¤ì•¼ í•  ìˆ˜ë„ ìˆìœ¼ë‹ˆ ë³´í˜¸ì ì „í™”ë²ˆí˜¸ë„ ë¶€íƒí•´~ *</label>
        <input type="tel" id="parentPhone" placeholder="ì˜ˆ: 01012345678" pattern="[0-9]{10,11}" required>
      </div>
      
      <div class="form-group privacy-check">
        <input type="checkbox" id="consent" required>
        <label for="consent">ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤</label>
      </div>
      <p class="privacy-note">
        â€» ì…ë ¥í•œ ê°œì¸ì •ë³´ëŠ” ì´ë²¤íŠ¸ ì°¸ì—¬ í™•ì¸ ë° ê²°ê³¼ ì „ë‹¬ì„ ìœ„í•´ì„œë§Œ ì‚¬ìš©ë˜ë©°, ã€Œê°œì¸ì •ë³´ ë³´í˜¸ë²•ã€ì— ë”°ë¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë©ë‹ˆë‹¤. 
        ì œ3ìì—ê²Œ ì œê³µë˜ì§€ ì•Šìœ¼ë©°, í–‰ì‚¬ ì¢…ë£Œ í›„ ì¦‰ì‹œ íŒŒê¸°ë©ë‹ˆë‹¤. ëª¨ë“  ì ˆì°¨ëŠ” ë°˜ë“œì‹œ ë³´í˜¸ì ë™ì˜ í•˜ì— ì§„í–‰ë©ë‹ˆë‹¤.
      </p>
      
      <button type="submit" class="start-btn">ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°</button>
    </form>
  </div>

  <!-- 3) ê²°ê³¼ -->
  <div id="resultScreen" class="screen">
    <!-- ê²°ê³¼ í™”ë©´ì—ë„ ë™ì¼ ì˜ìƒ ë…¸ì¶œ -->
    <video autoplay muted loop playsinline webkit-playsinline>
      <source src="dimo.mp4" type="video/mp4">
    </video>

    <div id="celebrationArea" class="celebration-card">
      <h2 class="banner">ğŸ‰ ì¶•í•˜í•´ìš”! ë‚˜ë§Œì˜ ì•„ì´ë””ì–´ ì¹´ë“œ ğŸ‰</h2>
      <div class="card-body">
        <img id="dimoImage" src="" alt="ë””ëª¨ ìºë¦­í„°" class="dimo-left">
        <div class="ratings-wrap">
          <div class="rating"><h3>ë°˜ì§ì´ëŠ” ìƒìƒë ¥</h3><div id="creativity" class="stars"></div></div>
          <div class="rating"><h3>ì •ë§ ë ê¹Œ? ì ìˆ˜</h3><div id="feasibility" class="stars"></div></div>
          <div class="rating"><h3>ë””ëª¨ì˜ ê¸°ìˆ ë ¥ ë ˆë²¨</h3><div id="technical" class="stars"></div></div>
        </div>
      </div>
      <div id="ideaInfo" class="idea-info">
        ğŸ‘¤ <strong>ë°œëª…ì:</strong> <span id="inventorName"></span> &nbsp;&nbsp; | &nbsp;&nbsp; ğŸ’¡ <strong>ë‚´ ë°œëª…í’ˆ:</strong> <span id="ideaDisplay"></span>
      </div>
      <div class="card-footer-logo">DIMO UNIVERSE</div>
      <div id="stampArea"></div>
    </div>
    <button id="shareBtn" class="start-btn">ğŸ¨ ì¹´ë“œ ì €ì¥í•˜ê¸°</button>
  </div>

  <!-- ì¹­ì°¬ ì˜¤ë””ì˜¤ -->
  <audio id="compliment1" src="ë””ëª¨ì¹­ì°¬01.mp3" preload="auto"></audio>
  <audio id="compliment2" src="ë””ëª¨ì¹­ì°¬02.mp3" preload="auto"></audio>
  <audio id="compliment3" src="ë””ëª¨ì¹­ì°¬03.mp3" preload="auto"></audio>
  <audio id="compliment4" src="ë””ëª¨ì¹­ì°¬04.mp3" preload="auto"></audio>
  <audio id="compliment5" src="ë””ëª¨ì¹­ì°¬05.mp3" preload="auto"></audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    const dimoImages = ["dimo01.png","dimo02.png","dimo03.png","dimo04.png"];
    const introAudios = [
      document.getElementById("introAudio1"),
      document.getElementById("introAudio2"),
      document.getElementById("introAudio3"),
      document.getElementById("introAudio4")
    ];
    const complimentAudios = [
      document.getElementById("compliment1"),
      document.getElementById("compliment2"),
      document.getElementById("compliment3"),
      document.getElementById("compliment4"),
      document.getElementById("compliment5")
    ];

    // â–¶ ì¸íŠ¸ë¡œ: ì˜¤ë””ì˜¤ ëë‚œ í›„ 2ì´ˆ ë’¤ ì „í™˜ + ì‹¤íŒ¨ í´ë°± 2ì´ˆ + 10ì´ˆ ê°€ë“œ
    let introLocked = false;
    document.getElementById("introBtn").addEventListener("click", ()=>{
      if (introLocked) return;
      introLocked = true;
      const move = ()=>{ document.getElementById("introScreen").classList.remove("active"); document.getElementById("formScreen").classList.add("active"); };
      const guard = setTimeout(move, 10000);

      const audio = introAudios[Math.floor(Math.random()*introAudios.length)];
      try{
        audio.currentTime=0; audio.muted=false; audio.volume=1.0;
        const p = audio.play();
        if (p && typeof p.then==='function'){
          p.then(()=>{
            audio.onended = ()=>{ clearTimeout(guard); setTimeout(move, 2000); };
          }).catch(()=>{ clearTimeout(guard); setTimeout(move, 2000); });
        } else {
          audio.onended = ()=>{ clearTimeout(guard); setTimeout(move, 2000); };
        }
      }catch(_){ clearTimeout(guard); setTimeout(move, 2000); }
    });

    function renderRandomStars(id){
      const el=document.getElementById(id);
      // 3.5~5.0 ì‚¬ì´ í•˜í”„ ìŠ¤íƒ€ í¬í•¨ (ì›ë¬¸ ë¡œì§ ìœ ì§€)
      let score = (Math.floor((Math.random() * ((5-3.5)*2+1)) + 7) / 2);
      let html="";
      for(let i=1;i<=5;i++){
        if(score >= i){ html += "<span class='star full'>â˜…</span>"; }
        else if(score >= i-0.5){ html += "<span class='star half'>â˜…</span>"; }
        else { html += "<span class='star'>â˜…</span>"; }
      }
      el.innerHTML = html;
    }

    function fireConfetti(duration=2000){ 
      const end=Date.now()+duration; 
      (function frame(){ 
        confetti({particleCount:5,startVelocity:30,spread:360,origin:{x:Math.random(),y:Math.random()-0.2}}); 
        if(Date.now()<end) requestAnimationFrame(frame); 
      })(); 
    }

    // ì¹´ë“œ ì €ì¥
    document.getElementById("shareBtn").addEventListener("click", function(){
      const card = document.getElementById("celebrationArea");
      html2canvas(card, { scale: window.devicePixelRatio || 1 }).then(canvas => {
        const link=document.createElement("a");
        link.href=canvas.toDataURL("image/png");
        link.download="dimo_card.png";
        link.click();
      });
    });

    // ì œì¶œ â†’ ê²°ê³¼
    document.getElementById("ideaForm").addEventListener("submit", function(e){ 
      e.preventDefault(); 
      // ê²°ê³¼ í™”ë©´ìœ¼ë¡œ ì „í™˜ ë° ë°ì´í„° ë°”ì¸ë”©
      document.getElementById("formScreen").classList.remove("active");
      document.getElementById("resultScreen").classList.add("active");

      const randomImg = dimoImages[Math.floor(Math.random()*dimoImages.length)];
      document.getElementById("dimoImage").src = randomImg;
      document.getElementById("inventorName").innerText = document.getElementById("nickname").value;
      document.getElementById("ideaDisplay").innerText = document.getElementById("ideaName").value;

      // ë³„ì ì€ ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ê³  ìˆœì°¨ ì¶œë ¥(ì›ë˜ ë§› ì‚´ë¦¬ê¸°)
      setTimeout(()=>{
        ["creativity","feasibility","technical"].forEach(id=>renderRandomStars(id));
        
        setTimeout(()=>{ fireConfetti(2000); },3000);

        const compliment = complimentAudios[Math.floor(Math.random()*complimentAudios.length)];
        compliment.currentTime = 0;
        compliment.play().catch(()=>{});

        setTimeout(()=>{
          const stampArea = document.getElementById("stampArea");
          const card = document.getElementById("celebrationArea");
          const detail = document.getElementById("ideaDetail").value || "";
          const pureLen = detail.replace(/\s/g, "").length;

          if (pureLen >= 30) {
            const stampSize = 132;
            const offset = 24;
            const posX = card.clientWidth  - stampSize - offset;
            const posY = offset;

            stampArea.innerHTML = `
              <img src="ë””ëª¨ìŠ¤íƒ¬í”„01.png" alt="ìŠ¤íƒ¬í”„"
                   style="position:absolute; left:${posX}px; top:${posY}px; width:${stampSize}px;">`;
          } else {
            stampArea.innerHTML = "";
          }
        },2000);

      },2000);
    });

    // ìŠ¤íƒ¬í”„ ì• ë‹ˆë©”ì´ì…˜(ì›ë¬¸ ìœ ì§€)
    (function(){
      const area = document.getElementById('stampArea');
      const card = document.getElementById('celebrationArea');
      if(!area || !card) return;

      function decorate(img){
        img.style.setProperty('--r', (Math.random()*8 - 4).toFixed(1) + 'deg');
        img.classList.add('stamp-enter');
        card.classList.add('paper-jolt');
        setTimeout(()=> card.classList.remove('paper-jolt'), 240);
      }
      const mo = new MutationObserver(muts=>{
        muts.forEach(m=>{
          m.addedNodes && m.addedNodes.forEach(n=>{
            if(n.tagName === 'IMG'){ requestAnimationFrame(()=>decorate(n)); }
          });
        });
      });
      mo.observe(area, { childList:true });
    })();
  </script>
</body>
</html>
