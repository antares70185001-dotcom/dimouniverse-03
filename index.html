<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë””ëª¨ ë°œëª… ì¹´ë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700;800&display=swap" rel="stylesheet">

  <style>
    :root { 
      --main:#5cab6d; --accent:#a5e6b8; --bg:#f8fff9;
      --shadow:0 12px 40px rgba(0,0,0,0.3);
    }
    *{ box-sizing:border-box; }
    body{ font-family:"Arial",sans-serif; background:var(--bg); text-align:center; margin:0; padding:20px; }
    .screen{ display:none; }
    .screen.active{ display:block; }

    /* ê³µí†µ ë²„íŠ¼ */
    .btn{ background:var(--accent); border:none; padding:14px 28px; border-radius:28px;
          cursor:pointer; font-size:18px; font-weight:700; color:#1f3b2b; margin:12px; transition:.2s; }
    .btn:hover{ background:#8ed8a3; transform:translateY(-1px); }

    /* ë¹„ë””ì˜¤ */
    video{ width:780px; max-width:100%; border-radius:20px; margin:20px auto; display:block; box-shadow:var(--shadow); }

    /* ì¸íŠ¸ë¡œ */
    .title{ font-family:'Jua',sans-serif; font-size:58px; font-weight:800; margin:12px 0 10px; color:#5cab6d; }

    /* ì„¤ë¬¸ */
    .section-title{ font-family:'Jua',sans-serif; font-size:28px; font-weight:700; color:#2d4d38; margin:10px auto 6px; width:100%; max-width:680px; text-align:left; }
    form{ background:#fff; border-radius:20px; padding:30px; display:flex; flex-direction:column; text-align:left; max-width:680px; width:100%; margin:20px auto; 
          box-shadow:0 6px 20px rgba(0,0,0,0.08); border:3px solid var(--accent);}
    .form-group{ margin-bottom:20px; }
    label{ font-weight:bold; font-size:17px; color:#000; display:block; margin-bottom:8px; }
    input,textarea,select{ width:100%; padding:12px; border-radius:10px; border:2px solid #d3f2db; font-size:15px; background:#fafffa; transition:border .2s, box-shadow .2s; }
    input:focus,textarea:focus,select:focus{ outline:none; border:2px solid var(--main); box-shadow:0 0 8px rgba(92,171,109,.3); }
    textarea{ min-height:110px; }
    .privacy-check{ display:flex; align-items:center; gap:8px; margin-top:10px; }
    .privacy-check input{ width:20px; height:20px; accent-color: var(--main); }
    .privacy-note{ font-size:13px; color:#333; background:#f3fff6; padding:12px; border-radius:10px; border:1px dashed var(--main); }

    /* ê²°ê³¼ ì¹´ë“œ */
    .celebration-card{
      background:#ffffff; border:3px solid var(--accent); border-radius:20px; padding:16px 16px 64px;
      max-width:720px; margin:12px auto; box-shadow:0 8px 24px rgba(0,0,0,.12); position:relative; width:100%; overflow:hidden;
    }
    .banner{ font-family:'Jua',sans-serif; font-size:32px; font-weight:bold; color:var(--main);
             margin:0 0 8px 0; text-align:center; width:100%; text-shadow:2px 2px 6px rgba(0,0,0,.15); }
    .card-body{ display:grid; grid-template-columns:auto 1fr; gap:14px; align-items:center; }
    .dimo-left{ width:176px; height:auto; border-radius:16px; flex-shrink:0; align-self:center; object-fit:contain; margin-left:4px; }
    .ratings-wrap{ flex:1; min-width:0; text-align:left; }
    .rating{ display:flex; justify-content:space-between; align-items:center; background:#f9fffb; border:2px solid #d3f2db; border-radius:10px; padding:8px 12px; margin:6px 0; white-space:nowrap; }
    .rating h3{ margin:0; font-size:16px; font-weight:bold; color:var(--main); flex:1; white-space:nowrap; }
    .stars{ display:flex; gap:4px; white-space:nowrap; font-size:26px; }
    .star{ position:relative; color:#d8d8d8; }
    .star.full{ color:#ffcc00; text-shadow:1px 1px 6px rgba(255,204,0,.7);}
    .star.half::before{ content:"â˜…"; position:absolute; left:0; top:0; width:50%; overflow:hidden; color:#ffcc00; text-shadow:1px 1px 6px rgba(255,204,0,.7); }
    .idea-info{ margin-top:12px; margin-bottom:24px; font-size:18px; font-weight:bold; color:#333; text-align:center; background:#f9fffb; padding:10px 14px; 
                border-radius:16px; border:2px solid #d3f2db; max-width:720px; margin-left:auto; margin-right:auto; line-height:1.8;
                word-break:keep-all; overflow-wrap:anywhere; }
    .idea-info strong{ color:var(--main); }

    /* ìŠ¤íƒ¬í”„ ì˜ì—­ */
    #stampArea{ position:absolute; top:0; left:0; right:0; bottom:0; pointer-events:none; }

    /* í•˜ë‹¨ ë¡œê³ (ì˜ë¬¸) */
    .card-footer-logo{
      position:absolute; left:0; right:0; bottom:8px; text-align:center; font-size:22px; font-weight:700; letter-spacing:.18em;
      text-transform:uppercase; color:#8aa0a6; opacity:.9; pointer-events:none; user-select:none;
      font-family:'Baloo 2', cursive, sans-serif;
      background:linear-gradient(90deg,#5cab6d,#3c9d9b,#6a5acd);
      -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; color:transparent;
    }

    /* ìŠ¤íƒ¬í”„ ì• ë‹ˆë©”ì´ì…˜ */
    .stamp-enter{ transform-origin:center; mix-blend-mode:multiply; filter: drop-shadow(0 6px 12px rgba(0,0,0,.10));
      animation: stamp-pop 520ms cubic-bezier(.18,1.4,.22,1) forwards, ink-fade 1200ms ease-out forwards; }
    @keyframes stamp-pop{
      0%{ opacity:0; transform: translateY(-16px) scale(1.35) rotate(var(--r,-4deg)); filter: blur(1px) drop-shadow(0 24px 36px rgba(0,0,0,.18)); }
      65%{ opacity:1; transform: translateY(0) scale(.97) rotate(var(--r,-4deg)); filter: drop-shadow(0 10px 18px rgba(0,0,0,.14)); }
      100%{ transform: scale(1) rotate(var(--r,-4deg)); filter: drop-shadow(0 6px 12px rgba(0,0,0,.10)); }
    }
    .celebration-card.paper-jolt{ animation: paper-jolt 220ms cubic-bezier(.3,.7,.4,1) 1; }
    @keyframes paper-jolt{
      0%{ transform: translateY(0) rotate(0); }
      30%{ transform: translateY(1px) rotate(-0.25deg); }
      60%{ transform: translateY(0) rotate(0.15deg); }
      100%{ transform: translateY(0) rotate(0); }
    }

    /* ëª¨ë°”ì¼ ë³´ê°•(ë””ìì¸ íŒ¨ì¹˜) */
    .banner{ font-size: clamp(22px, 6.5vw, 32px); line-height:1.15; word-break:keep-all; }
    .dimo-left{ width: clamp(120px, 32vw, 180px); }
    .rating h3{ font-size: clamp(14px, 4.2vw, 18px); }
    .stars{ font-size: clamp(18px, 5vw, 26px); flex-shrink:0; }
    .idea-info{ font-size: clamp(14px, 4vw, 18px); }
    @media (max-width: 480px){
      body{ padding:12px; }
      .title{ font-size: 36px; margin: 8px 0; }
      .celebration-card{ padding:12px 12px 56px; }
      .rating{ padding:6px 10px; gap:8px; }
      .idea-info{ margin-bottom:14px; }
    }
  </style>
</head>
<body>

  <!-- 1) ì¸íŠ¸ë¡œ -->
  <div id="introScreen" class="screen active">
    <h1 class="title">ë””ëª¨ë‘ í•¨ê»˜í•˜ëŠ” ë°œëª… ë†€ì´í„° âœ¨</h1>
    <button id="goFormBtn" class="btn">â–¶ ë””ëª¨ ë§Œë‚˜ëŸ¬ ê°€ê¸°</button>
    <video autoplay muted loop playsinline webkit-playsinline>
      <source src="dimo.mp4" type="video/mp4">
    </video>
    <!-- ì¸íŠ¸ë¡œ ì˜¤ë””ì˜¤ (ëœë¤ 1ê°œ ì¬ìƒ) -->
    <audio id="introAudio1" src="ë””ëª¨ ì¸íŠ¸ë¡œ ì¸ì‚¬.mp3" preload="auto"></audio>
    <audio id="introAudio2" src="ë””ëª¨ì¸ì‚¬01.mp3" preload="auto"></audio>
    <audio id="introAudio3" src="ë””ëª¨ì¸ì‚¬02.mp3" preload="auto"></audio>
    <audio id="introAudio4" src="ë””ëª¨ì¸ì‚¬03.mp3" preload="auto"></audio>
  </div>

  <!-- 2) ì„¤ë¬¸ -->
  <div id="formScreen" class="screen">
    <h2 class="section-title">ğŸ“£ ë””ëª¨ì—ê²Œ ì•Œë ¤ì¤˜</h2>
    <form id="ideaForm">
      <div class="form-group">
        <label>1. ë””ëª¨ëŠ” ì¹œêµ¬ ë‚˜ì´ê°€ ê¶ê¸ˆí•´! *</label>
        <select id="age" required>
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="8">8ì„¸</option><option value="9">9ì„¸</option><option value="10">10ì„¸</option>
          <option value="11">11ì„¸</option><option value="12">12ì„¸</option><option value="13">13ì„¸</option>
          <option value="14">14ì„¸</option><option value="15">15ì„¸</option><option value="16">16ì„¸</option>
          <option value="17">17ì„¸</option><option value="18">18ì„¸</option><option value="19">19ì„¸</option>
        </select>
      </div>

      <div class="form-group">
        <label>2. ë””ëª¨ì—ê²Œ ë„ˆë§Œì˜ ë©‹ì§„ ë³„ëª…ì„ ì •í•´ì¤˜! (ì‹¤ëª…ë§ê³  ë³„ëª…ìœ¼ë¡œ) *</label>
        <input type="text" id="nickname" placeholder="ì˜ˆ: ë°œëª…ì™• ë””ëª¨!" required>
      </div>

      <div class="form-group">
        <label>3. í‰ì†Œì— "ì•„~ ì´ê±° ë¶ˆí¸í•˜ë‹¤!" ì‹¶ì—ˆë˜ ìˆœê°„ì´ ìˆì—ˆì–´? ë””ëª¨í•œí…Œ ë§í•´ì¤„ë˜? *</label>
        <textarea id="problem" placeholder="ì˜ˆ: ì—°í•„ì´ ìê¾¸ êµ´ëŸ¬ê°€ì„œ ìƒì–´ë²„ë ¤ìš”" required></textarea>
      </div>

      <div class="form-group">
        <label>4. ê·¸ ë¶ˆí¸ì„ í•´ê²°í•  ë©‹ì§„ ë°œëª…í’ˆ ì´ë¦„ì„ ë”±! ì§€ì–´ë³¼ê¹Œ? *</label>
        <input type="text" id="ideaName" placeholder="ì˜ˆ: ì•ˆ êµ´ëŸ¬ê°€ëŠ” ì—°í•„" required>
      </div>

      <div class="form-group">
        <label>5. ì´ ë°œëª…í’ˆì€ ì–´ë–»ê²Œ ì‘ë™í•˜ê³  ì–´ë–¤ì ì´ í¸ë¦¬í•´ ì§€ëŠ”ê±°ì•¼? *</label>
        <textarea id="ideaDetail" placeholder="ì˜ˆ: ì—°í•„ì— ì‘ì€ ìì„ì´ ë¶™ì–´ì„œ ì±…ìƒì— ë”± ë‹¬ë¼ ë¶™ì–´ìš”. ê·¸ë˜ì„œ ì§€ìš°ê°œë¥¼ ì˜ ìŠì–´ë²„ë¦¬ì§€ ì•Šê³  í•„ìš”í•  ë•Œë§ˆë‹¤ ì“¸ ìˆ˜ ìˆì–´ìš”. (30ì ì´ìƒ ì‘ì„±í•˜ë©´ ë””ëª¨ê°€ ìŠ¤íƒ¬í”„ë¥¼ ì°ì–´ì¤„ê±°ì•¼!)" required></textarea>
      </div>

      <div class="form-group">
        <label>6. ë””ëª¨ëŠ” ë¶€ëª¨ë‹˜ê»˜ë„ ì¸ì‚¬ë“œë¦¬ê³  ì‹¶ì€ë°? ë³´í˜¸ì ì„±í•¨ì„ ì•Œë ¤ì¤„ë˜? *</label>
        <input type="text" id="parentName" placeholder="ì˜ˆ: ê¹€ì² ìˆ˜" required>
      </div>

      <div class="form-group">
        <label>7. í˜¹ì‹œ ë””ëª¨ê°€ ì—°ë½ë“œë ¤ì•¼ í•  ìˆ˜ë„ ìˆìœ¼ë‹ˆ ë³´í˜¸ì ì „í™”ë²ˆí˜¸ë„ ë¶€íƒí•´~ *</label>
        <input type="tel" id="parentPhone" placeholder="ì˜ˆ: 01012345678" pattern="[0-9]{10,11}" required>
      </div>

      <div class="form-group privacy-check">
        <input type="checkbox" id="consent" required>
        <label for="consent">ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤</label>
      </div>
      <p class="privacy-note">
        â€» ì…ë ¥í•œ ê°œì¸ì •ë³´ëŠ” ì´ë²¤íŠ¸ ì°¸ì—¬ í™•ì¸ ë° ê²°ê³¼ ì „ë‹¬ì„ ìœ„í•´ì„œë§Œ ì‚¬ìš©ë˜ë©°, ã€Œê°œì¸ì •ë³´ ë³´í˜¸ë²•ã€ì— ë”°ë¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë©ë‹ˆë‹¤. 
        ì œ3ìì—ê²Œ ì œê³µë˜ì§€ ì•Šìœ¼ë©°, í–‰ì‚¬ ì¢…ë£Œ í›„ ì¦‰ì‹œ íŒŒê¸°ë©ë‹ˆë‹¤. ëª¨ë“  ì ˆì°¨ëŠ” ë°˜ë“œì‹œ ë³´í˜¸ì ë™ì˜ í•˜ì— ì§„í–‰ë©ë‹ˆë‹¤.
      </p>

      <button type="submit" class="btn">ë””ëª¨ì—ê²Œ ë³´ë‚´ê¸°</button>
    </form>
  </div>

  <!-- 3) ê²°ê³¼ -->
  <div id="resultScreen" class="screen">
    <!-- ê²°ê³¼ í™”ë©´ ìƒë‹¨ ë°°ê²½/ë£¨í”„ ì˜ìƒ -->
    <video autoplay muted loop playsinline webkit-playsinline>
      <source src="dimo.mp4" type="video/mp4">
    </video>

    <div id="celebrationArea" class="celebration-card">
      <h2 class="banner">ğŸ‰ ì¶•í•˜í•´ìš”! ë‚˜ë§Œì˜ ì•„ì´ë””ì–´ ì¹´ë“œ ğŸ‰</h2>

      <div class="card-body">
        <img id="dimoImage" src="" alt="ë””ëª¨ ìºë¦­í„°" class="dimo-left">
        <div class="ratings-wrap">
          <div class="rating"><h3>ë°˜ì§ì´ëŠ” ìƒìƒë ¥</h3><div id="creativity" class="stars"></div></div>
          <div class="rating"><h3>ì •ë§ ë ê¹Œ? ì ìˆ˜</h3><div id="feasibility" class="stars"></div></div>
          <div class="rating"><h3>ë””ëª¨ì˜ ê¸°ìˆ ë ¥ ë ˆë²¨</h3><div id="technical" class="stars"></div></div>
        </div>
      </div>

      <div id="ideaInfo" class="idea-info">
        ğŸ‘¤ <strong>ë°œëª…ì:</strong> <span id="inventorName"></span> &nbsp;&nbsp; | &nbsp;&nbsp; ğŸ’¡ <strong>ë‚´ ë°œëª…í’ˆ:</strong> <span id="ideaDisplay"></span>
      </div>

      <div class="card-footer-logo">DIMO UNIVERSE</div>
      <div id="stampArea"></div>
    </div>

    <button id="shareBtn" class="btn">ğŸ¨ ì¹´ë“œ ì €ì¥í•˜ê¸°</button>

    <!-- ì¹­ì°¬ ì˜¤ë””ì˜¤ (ëœë¤ 1ê°œ ì¬ìƒ) -->
    <audio id="compliment1" src="ë””ëª¨ì¹­ì°¬01.mp3" preload="auto"></audio>
    <audio id="compliment2" src="ë””ëª¨ì¹­ì°¬02.mp3" preload="auto"></audio>
    <audio id="compliment3" src="ë””ëª¨ì¹­ì°¬03.mp3" preload="auto"></audio>
    <audio id="compliment4" src="ë””ëª¨ì¹­ì°¬04.mp3" preload="auto"></audio>
    <audio id="compliment5" src="ë””ëª¨ì¹­ì°¬05.mp3" preload="auto"></audio>
    <audio id="compliment6" src="ë””ëª¨ ì¹­ì°¬ ë©”ì‹œì§€.mp3" preload="auto"></audio>
  </div>

  <!-- Libs -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <script>
    // íŒŒì¼ ëª©ë¡
    const dimoImages = ["dimo01.png","dimo02.png","dimo03.png","dimo04.png"];

    // ì¸íŠ¸ë¡œ ë¡œì§: ë²„íŠ¼ í´ë¦­ ì‹œ ëœë¤ ì˜¤ë””ì˜¤ ì¬ìƒ â†’ ëë‚˜ë©´ 2ì´ˆ ë’¤ ì„¤ë¬¸ìœ¼ë¡œ
    (function setupIntro(){
      const btn = document.getElementById('goFormBtn');
      const introScreen = document.getElementById('introScreen');
      const formScreen  = document.getElementById('formScreen');

      const introAudios = ["introAudio1","introAudio2","introAudio3","introAudio4"]
        .map(id => document.getElementById(id))
        .filter(Boolean);

      let locked = false;
      btn.addEventListener('click', () => {
        if (locked) return;
        locked = true;
        btn.disabled = true; btn.style.opacity = .7; btn.style.cursor = 'default';

        const pick = arr => arr[Math.floor(Math.random()*arr.length)];
        const audio = introAudios.length ? pick(introAudios) : null;

        // 10ì´ˆ ê°€ë“œ(ëª¨ë°”ì¼ ìë™ì¬ìƒ ì œí•œ ëŒ€ë¹„)
        const GUARD_MS = 10000;
        let guard = setTimeout(() => gotoForm(), GUARD_MS);

        function gotoForm(){
          clearTimeout(guard);
          introScreen.classList.remove('active');
          formScreen.classList.add('active');
        }

        if (!audio){
          // ì˜¤ë””ì˜¤ê°€ ì—†ìœ¼ë©´ 2.5ì´ˆ í›„ í¼ìœ¼ë¡œ
          setTimeout(gotoForm, 2500);
          return;
        }

        try{
          audio.currentTime = 0;
          audio.muted = false;
          const p = audio.play();
          if (p && typeof p.then === 'function'){
            p.then(() => {
              // ì •ìƒ ì¬ìƒ ì‹œì‘ â†’ ëë‚˜ë©´ 2ì´ˆ í›„ ì „í™˜
              audio.onended = () => setTimeout(gotoForm, 2000);
              // ë°±ì—… íƒ€ì´ë¨¸(ì˜¤ë””ì˜¤ ê¸¸ì´ + 2.5s)
              const backup = Math.max(GUARD_MS, ((audio.duration || 0)*1000)+2500);
              clearTimeout(guard);
              guard = setTimeout(gotoForm, backup);
            }).catch(() => {
              // ì‹¤íŒ¨ì‹œì—ë„ ê°€ë“œê°€ í´ë°± ì²˜ë¦¬
            });
          }else{
            // ë ˆê±°ì‹œ ë¸Œë¼ìš°ì €
            audio.onended = () => setTimeout(gotoForm, 2000);
          }
        }catch(e){
          // ì˜ˆì™¸ ë°œìƒí•´ë„ ê°€ë“œê°€ í´ë°± ì²˜ë¦¬
        }
      });
    })();

    // ì„¤ë¬¸ ì œì¶œ â†’ ê²°ê³¼ í™”ë©´ ì¡°ë¦½
    (function setupForm(){
      const formScreen = document.getElementById('formScreen');
      const resultScreen = document.getElementById('resultScreen');

      const inventorName = document.getElementById('inventorName');
      const ideaDisplay  = document.getElementById('ideaDisplay');
      const dimoImage    = document.getElementById('dimoImage');
      const stampArea    = document.getElementById('stampArea');

      function renderRandomStars(id){
        const el = document.getElementById(id);
        // 3.5 ~ 5.0 ì‚¬ì´ 0.5ë‹¨ìœ„
        const score = Math.round((3.5 + Math.random()*1.5) * 2) / 2;
        let html = "";
        for (let i=1;i<=5;i++){
          if (score >= i) html += "<span class='star full'>â˜…</span>";
          else if (score >= i-0.5) html += "<span class='star half'>â˜…</span>";
          else html += "<span class='star'>â˜…</span>";
        }
        el.innerHTML = html;
      }

      // ì¹­ì°¬ ì˜¤ë””ì˜¤ë“¤(ì¡´ì¬í•˜ëŠ” ê²ƒë§Œ ì‚¬ìš©)
      const complimentAudios = ["compliment1","compliment2","compliment3","compliment4","compliment5","compliment6"]
        .map(id => document.getElementById(id))
        .filter(Boolean);

      // ì¶•í¬
      function fireConfetti(duration=2000){
        const end = Date.now() + duration;
        (function frame(){
          confetti({particleCount:5,startVelocity:30,spread:360,origin:{x:Math.random(),y:Math.random()-0.2}});
          if (Date.now() < end) requestAnimationFrame(frame);
        })();
      }

      document.getElementById('ideaForm').addEventListener('submit', (e)=>{
        e.preventDefault();

        // ë°ì´í„° ë°”ì¸ë”©
        inventorName.textContent = document.getElementById('nickname').value;
        ideaDisplay.textContent  = document.getElementById('ideaName').value;

        // ëœë¤ ë””ëª¨ ì´ë¯¸ì§€
        dimoImage.src = dimoImages[Math.floor(Math.random()*dimoImages.length)];

        // ë³„ì 
        ["creativity","feasibility","technical"].forEach(renderRandomStars);

        // í™”ë©´ ì „í™˜
        formScreen.classList.remove('active');
        resultScreen.classList.add('active');

        // ì¹­ì°¬ ì˜¤ë””ì˜¤ ëœë¤
        const pick = arr => arr[Math.floor(Math.random()*arr.length)];
        const compliment = complimentAudios.length ? pick(complimentAudios) : null;
        if (compliment){
          try{ compliment.currentTime = 0; compliment.play().catch(()=>{}); }catch(_){}
        }

        // ì„¤ëª… ê¸¸ì´ì— ë”°ë¼ ìŠ¤íƒ¬í”„(ê³µë°± ì œì™¸ 30ì ì´ìƒ)
        setTimeout(()=>{
          const detail = (document.getElementById('ideaDetail').value || "").replace(/\s/g,"");
          if (detail.length >= 30){
            // ì¹´ë“œ ìš°ì¸¡ ìƒë‹¨ ìì—°ìŠ¤ëŸ¬ìš´ ìœ„ì¹˜
            const card = document.getElementById('celebrationArea');
            const size = 132, offset = 24;
            const posX = card.clientWidth - size - offset, posY = offset;
            stampArea.innerHTML = `<img src="ë””ëª¨ìŠ¤íƒ¬í”„01.png" alt="ìŠ¤íƒ¬í”„" style="position:absolute;left:${posX}px;top:${posY}px;width:${size}px;">`;
          }else{
            stampArea.innerHTML = "";
          }
          // ë“±ì¥ ì• ë‹ˆ + ì‚´ì§ í”ë“¤ë¦¼
          const img = stampArea.querySelector('img');
          if (img){ img.style.setProperty('--r',(Math.random()*8-4).toFixed(1)+'deg'); img.classList.add('stamp-enter');
            const card = document.getElementById('celebrationArea'); card.classList.add('paper-jolt'); setTimeout(()=>card.classList.remove('paper-jolt'),240);
          }
        }, 1600);

        // ì¶•í•˜ ì½˜í˜í‹°(ì‚´ì§ ë”œë ˆì´)
        setTimeout(()=> fireConfetti(2000), 800);
      });
    })();

    // ì¹´ë“œ ì €ì¥
    (function setupSave(){
      const btn = document.getElementById('shareBtn');
      btn.addEventListener('click', ()=>{
        const card = document.getElementById('celebrationArea');
        html2canvas(card, { scale: window.devicePixelRatio || 1 }).then(canvas=>{
          const link = document.createElement('a');
          link.href = canvas.toDataURL('image/png');
          link.download = 'dimo_card.png';
          link.click();
        });
      });
    })();
  </script>
</body>
</html>
